# АНАЛИЗ ВАРИАНТОВ ТОВАРОВ

## Статистика

- **Всего товаров без variant_group_id**: 998
- **Найдено групп для объединения**: 34
- **Товаров будет сгруппировано**: ~100+

---

## НАЙДЕННЫЕ ГРУППЫ

На основе анализа базы данных найдены следующие группы товаров, которые нужно объединить:

### ГРУППА 1: veshalka-ayden-ldsp-вш06
**Базовое название:** Вешалка Айден ЛДСП / ЛДСП

- ID 518 → color_variant: "white"
  - Вешалка Айден ВШ06-600 белый ЛДСП / белый ЛДСП
  - Остаток: 0 | Категория: Гостиная | Артикул: 08-147206

- ID 521 → color_variant: "grey"
  - Вешалка Айден ВШ06-600 серый ЛДСП / серый ЛДСП
  - Остаток: 0 | Категория: Гостиная | Артикул: 08-147208

- ID 558 → color_variant: "white"
  - Вешалка Айден ВШ06-800 белый ЛДСП / белый ЛДСП
  - Остаток: 0 | Категория: Гостиная | Артикул: 08-147209

---

### ГРУППА 2: gostinaya-alfa
**Базовое название:** Гостиная Альфа

- ID 971 → color_variant: "white"
  - Гостиная Альфа (Белый/Белый глянец)
  - Остаток: 0 | Категория: Гостиная | Артикул: 57007

- ID 979 → color_variant: "white"
  - Гостиная Альфа (Дуб крафт золотой/Белый глянец)
  - Остаток: 0 | Категория: Гостиная | Артикул: 325354

- ID 947 → color_variant: "oak"
  - Гостиная Альфа (Дуб крафт золотой/Графит софт)
  - Остаток: 0 | Категория: Гостиная | Артикул: 57006

---

### ГРУППА 3: gostinaya-mgs-8
**Базовое название:** Гостиная МГС 8

- ID 916 → color_variant: "wenge"
  - Гостиная МГС 8 (Дуб Венге/Ясень Анкор светлый)
  - Остаток: 0 | Категория: Гостиная | Артикул: 200920238

- ID 907 → color_variant: "default"
  - Гостиная МГС 8 (Ясень Анкор светлый)
  - Остаток: 0 | Категория: Гостиная | Артикул: 200920239

---

### ГРУППА 4: gostinaya-pekin
**Базовое название:** Гостиная ПЕКИН

- ID 976 → color_variant: "wenge"
  - Гостиная ПЕКИН (венге/дуб белфорт)
  - Остаток: 0 | Категория: Гостиная | Артикул: 67783

- ID 966 → color_variant: "white"
  - Гостиная ПЕКИН (дуб сонома/белый глянец)
  - Остаток: 1 | Категория: Гостиная | Артикул: нет

---

## ИНСТРУКЦИЯ ПО ПРИМЕНЕНИЮ

### Автоматическая загрузка всех групп

1. **Откройте файл `analyze-variants.html` в браузере**
   - Нажмите кнопку "Загрузить данные"
   - Просмотрите все 34 найденные группы
   - Проверьте консоль браузера (F12) - там будет полный текстовый вывод

2. **Или выполните Node.js скрипт:**
   ```bash
   node fetch-variants.js
   ```
   
   Это выведет полный список всех 34 групп в консоль для копирования.

### Применение изменений в базе данных

Для каждой группы выполните SQL UPDATE запросы:

```sql
-- Пример для группы veshalka-ayden-ldsp-вш06
UPDATE products SET 
  variant_group_id = 'veshalka-ayden-ldsp-вш06',
  color_variant = 'white'
WHERE id = 518;

UPDATE products SET 
  variant_group_id = 'veshalka-ayden-ldsp-вш06',
  color_variant = 'grey'
WHERE id = 521;

UPDATE products SET 
  variant_group_id = 'veshalka-ayden-ldsp-вш06',
  color_variant = 'white'
WHERE id = 558;
```

### Полный список групп доступен:

1. **API Endpoint**: https://functions.poehali.dev/2654b969-f5e1-447b-9dc1-cce40403afb5
   - Возвращает JSON со всеми группами
   
2. **HTML интерфейс**: `analyze-variants.html`
   - Визуальный просмотр всех групп
   - Автоматическая статистика
   
3. **Node.js скрипт**: `fetch-variants.js`
   - Текстовый вывод для копирования

---

## СПИСОК ВСЕХ НАЙДЕННЫХ ГРУПП (краткий)

1. veshalka-ayden-ldsp-вш06 (3 варианта)
2. gostinaya-alfa (3 варианта)
3. gostinaya-mgs-8 (2 варианта)
4. gostinaya-pekin (2 варианта)
5. ... еще 30 групп

**Для просмотра всех 34 групп используйте инструменты выше.**

---

## ВАЖНЫЕ ЗАМЕЧАНИЯ

1. ✓ Группируются только товары со схожими названиями
2. ✓ Учитываются товары с остатком > 0 ИЛИ явные варианты (разные цвета)
3. ✓ variant_group_id генерируется автоматически в kebab-case
4. ✓ color_variant извлекается из названия товара
5. ✗ SQL UPDATE запросы НЕ создаются автоматически (только анализ)

---

## КАК ПОЛУЧИТЬ ПОЛНЫЕ ДАННЫЕ

### Вариант 1: Браузер
```
1. Откройте analyze-variants.html
2. Нажмите "Загрузить данные"
3. Откройте консоль (F12) 
4. Скопируйте весь вывод
```

### Вариант 2: cURL
```bash
curl https://functions.poehali.dev/2654b969-f5e1-447b-9dc1-cce40403afb5 | jq .
```

### Вариант 3: Node.js
```bash
node fetch-variants.js > full-report.txt
```

---

**Дата анализа:** 2025-10-20  
**Backend функция:** product-variants-analysis  
**База данных:** t_p46240159_larana_site_redesign.products
